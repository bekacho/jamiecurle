{% extends 'base.html' %}

{% block body_id %}blog{% endblock %}
{% block body_class %}show{% endblock%}
{% block content %}

<article>
	<header style="border-bottom-color: {{post.created|colour_for_date}}">
		<h1>{{post.title}}</h1>
		<p class="meta">
			Posted {{post.created|datetimeformat}}. 
			{% for tag in post.tags %}<a class="tag" href="/tags/{{tag}}/">{{tag}}</a><span>{% if loop.last %}.{% else %}, {% endif %}</span>{% endfor %}
		</p>
	</header>
	<p class="description">{{post.description}}</p>
	{{post.content|render|safe}}
</article>
{% endblock %}


{% block js %}
<script src="/static/js/fitvids.min.js" charset="utf-8" defer="defer"></script>
<script type="text/javascript" defer="defer">
$(function(){
	$('div.secondary nav').each(function(){
		//var nav = $(this);
		var queue = []
		$(this).find('.stale').each(function(){
			queue.push($(this));
			$(this).css({display: 'block'}).hide();
		})

		var toggler = $('<a>')
					.addClass('toggler')
					.css({display: 'block'})
					.toggle(show, hide)
					.text('Show more');


		function show(){
			var show_queue = queue.slice(0);
			while(show_queue.length > 0){
				var el = show_queue.pop();
				el.slideDown(300);
			}
			$(this).text('Show less');
		}

		function hide(){
			var hide_queue = queue.slice(0);
			while(hide_queue.length > 0){
				var el = hide_queue.pop();
				el.css({display: 'block'}).slideUp(200);
			}
			$(this).text('Show more');
		}
		$(this).find('a.stale:last').after(toggler);
	});
	$('article').fitVids();
});
</script>
{% endblock %}